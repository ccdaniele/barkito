{"ast":null,"code":"const IAST_CONTEXT_KEY = Symbol('_dd.iast.context');\n\nfunction getIastContext(store) {\n  return store && store[IAST_CONTEXT_KEY];\n}\n/* TODO Fix storage problem when the close event is called without\n        finish event to remove `topContext` references\n  We have to save the context in two places, because\n  clean can be called when the storage store is not available\n */\n\n\nfunction saveIastContext(store, topContext, context) {\n  if (store && topContext) {\n    store[IAST_CONTEXT_KEY] = context;\n    topContext[IAST_CONTEXT_KEY] = context;\n    return store[IAST_CONTEXT_KEY];\n  }\n}\n/* TODO Fix storage problem when the close event is called without\n        finish event to remove `topContext` references\n  iastContext is currently saved in store and request rootContext\n  to fix problems with `close` without `finish` events\n*/\n\n\nfunction cleanIastContext(store, context, iastContext) {\n  if (store) {\n    if (!iastContext) {\n      iastContext = store[IAST_CONTEXT_KEY];\n    }\n\n    store[IAST_CONTEXT_KEY] = null;\n  }\n\n  if (context) {\n    if (!iastContext) {\n      iastContext = context[IAST_CONTEXT_KEY];\n    }\n\n    context[IAST_CONTEXT_KEY] = null;\n  }\n\n  if (iastContext) {\n    Object.keys(iastContext).forEach(key => delete iastContext[key]);\n    return true;\n  }\n\n  return false;\n}\n\nmodule.exports = {\n  getIastContext,\n  saveIastContext,\n  cleanIastContext,\n  IAST_CONTEXT_KEY\n};","map":{"version":3,"names":["IAST_CONTEXT_KEY","Symbol","getIastContext","store","saveIastContext","topContext","context","cleanIastContext","iastContext","Object","keys","forEach","key","module","exports"],"sources":["/Users/daniel.calderon/Projects/barkito/barkito_front/node_modules/dd-trace/packages/dd-trace/src/appsec/iast/iast-context.js"],"sourcesContent":["const IAST_CONTEXT_KEY = Symbol('_dd.iast.context')\n\nfunction getIastContext (store) {\n  return store && store[IAST_CONTEXT_KEY]\n}\n\n/* TODO Fix storage problem when the close event is called without\n        finish event to remove `topContext` references\n  We have to save the context in two places, because\n  clean can be called when the storage store is not available\n */\nfunction saveIastContext (store, topContext, context) {\n  if (store && topContext) {\n    store[IAST_CONTEXT_KEY] = context\n    topContext[IAST_CONTEXT_KEY] = context\n    return store[IAST_CONTEXT_KEY]\n  }\n}\n\n/* TODO Fix storage problem when the close event is called without\n        finish event to remove `topContext` references\n  iastContext is currently saved in store and request rootContext\n  to fix problems with `close` without `finish` events\n*/\nfunction cleanIastContext (store, context, iastContext) {\n  if (store) {\n    if (!iastContext) {\n      iastContext = store[IAST_CONTEXT_KEY]\n    }\n    store[IAST_CONTEXT_KEY] = null\n  }\n  if (context) {\n    if (!iastContext) {\n      iastContext = context[IAST_CONTEXT_KEY]\n    }\n    context[IAST_CONTEXT_KEY] = null\n  }\n  if (iastContext) {\n    Object.keys(iastContext).forEach(key => delete iastContext[key])\n    return true\n  }\n  return false\n}\n\nmodule.exports = {\n  getIastContext,\n  saveIastContext,\n  cleanIastContext,\n  IAST_CONTEXT_KEY\n}\n"],"mappings":"AAAA,MAAMA,gBAAgB,GAAGC,MAAM,CAAC,kBAAD,CAA/B;;AAEA,SAASC,cAAT,CAAyBC,KAAzB,EAAgC;EAC9B,OAAOA,KAAK,IAAIA,KAAK,CAACH,gBAAD,CAArB;AACD;AAED;AACA;AACA;AACA;AACA;;;AACA,SAASI,eAAT,CAA0BD,KAA1B,EAAiCE,UAAjC,EAA6CC,OAA7C,EAAsD;EACpD,IAAIH,KAAK,IAAIE,UAAb,EAAyB;IACvBF,KAAK,CAACH,gBAAD,CAAL,GAA0BM,OAA1B;IACAD,UAAU,CAACL,gBAAD,CAAV,GAA+BM,OAA/B;IACA,OAAOH,KAAK,CAACH,gBAAD,CAAZ;EACD;AACF;AAED;AACA;AACA;AACA;AACA;;;AACA,SAASO,gBAAT,CAA2BJ,KAA3B,EAAkCG,OAAlC,EAA2CE,WAA3C,EAAwD;EACtD,IAAIL,KAAJ,EAAW;IACT,IAAI,CAACK,WAAL,EAAkB;MAChBA,WAAW,GAAGL,KAAK,CAACH,gBAAD,CAAnB;IACD;;IACDG,KAAK,CAACH,gBAAD,CAAL,GAA0B,IAA1B;EACD;;EACD,IAAIM,OAAJ,EAAa;IACX,IAAI,CAACE,WAAL,EAAkB;MAChBA,WAAW,GAAGF,OAAO,CAACN,gBAAD,CAArB;IACD;;IACDM,OAAO,CAACN,gBAAD,CAAP,GAA4B,IAA5B;EACD;;EACD,IAAIQ,WAAJ,EAAiB;IACfC,MAAM,CAACC,IAAP,CAAYF,WAAZ,EAAyBG,OAAzB,CAAiCC,GAAG,IAAI,OAAOJ,WAAW,CAACI,GAAD,CAA1D;IACA,OAAO,IAAP;EACD;;EACD,OAAO,KAAP;AACD;;AAEDC,MAAM,CAACC,OAAP,GAAiB;EACfZ,cADe;EAEfE,eAFe;EAGfG,gBAHe;EAIfP;AAJe,CAAjB"},"metadata":{},"sourceType":"script"}