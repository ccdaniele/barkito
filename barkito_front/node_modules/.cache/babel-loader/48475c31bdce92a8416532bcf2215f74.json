{"ast":null,"code":"'use strict';\n\nconst {\n  AsyncResource\n} = require('async_hooks');\n\nexports.wrapThen = function wrapThen(origThen) {\n  return function then(onFulfilled, onRejected, onProgress) {\n    const ar = new AsyncResource('bound-anonymous-fn');\n    arguments[0] = wrapCallback(ar, onFulfilled);\n    arguments[1] = wrapCallback(ar, onRejected); // not standard but sometimes supported\n\n    if (onProgress) {\n      arguments[2] = wrapCallback(ar, onProgress);\n    }\n\n    return origThen.apply(this, arguments);\n  };\n};\n\nfunction wrapCallback(ar, callback) {\n  if (typeof callback !== 'function') return callback;\n  return function () {\n    return ar.runInAsyncScope(() => {\n      return callback.apply(this, arguments);\n    });\n  };\n}","map":{"version":3,"names":["AsyncResource","require","exports","wrapThen","origThen","then","onFulfilled","onRejected","onProgress","ar","arguments","wrapCallback","apply","callback","runInAsyncScope"],"sources":["/Users/daniel.calderon/Projects/barkito/barkito_front/node_modules/dd-trace/packages/datadog-instrumentations/src/helpers/promise.js"],"sourcesContent":["'use strict'\n\nconst { AsyncResource } = require('async_hooks')\n\nexports.wrapThen = function wrapThen (origThen) {\n  return function then (onFulfilled, onRejected, onProgress) {\n    const ar = new AsyncResource('bound-anonymous-fn')\n\n    arguments[0] = wrapCallback(ar, onFulfilled)\n    arguments[1] = wrapCallback(ar, onRejected)\n\n    // not standard but sometimes supported\n    if (onProgress) {\n      arguments[2] = wrapCallback(ar, onProgress)\n    }\n\n    return origThen.apply(this, arguments)\n  }\n}\n\nfunction wrapCallback (ar, callback) {\n  if (typeof callback !== 'function') return callback\n\n  return function () {\n    return ar.runInAsyncScope(() => {\n      return callback.apply(this, arguments)\n    })\n  }\n}\n"],"mappings":"AAAA;;AAEA,MAAM;EAAEA;AAAF,IAAoBC,OAAO,CAAC,aAAD,CAAjC;;AAEAC,OAAO,CAACC,QAAR,GAAmB,SAASA,QAAT,CAAmBC,QAAnB,EAA6B;EAC9C,OAAO,SAASC,IAAT,CAAeC,WAAf,EAA4BC,UAA5B,EAAwCC,UAAxC,EAAoD;IACzD,MAAMC,EAAE,GAAG,IAAIT,aAAJ,CAAkB,oBAAlB,CAAX;IAEAU,SAAS,CAAC,CAAD,CAAT,GAAeC,YAAY,CAACF,EAAD,EAAKH,WAAL,CAA3B;IACAI,SAAS,CAAC,CAAD,CAAT,GAAeC,YAAY,CAACF,EAAD,EAAKF,UAAL,CAA3B,CAJyD,CAMzD;;IACA,IAAIC,UAAJ,EAAgB;MACdE,SAAS,CAAC,CAAD,CAAT,GAAeC,YAAY,CAACF,EAAD,EAAKD,UAAL,CAA3B;IACD;;IAED,OAAOJ,QAAQ,CAACQ,KAAT,CAAe,IAAf,EAAqBF,SAArB,CAAP;EACD,CAZD;AAaD,CAdD;;AAgBA,SAASC,YAAT,CAAuBF,EAAvB,EAA2BI,QAA3B,EAAqC;EACnC,IAAI,OAAOA,QAAP,KAAoB,UAAxB,EAAoC,OAAOA,QAAP;EAEpC,OAAO,YAAY;IACjB,OAAOJ,EAAE,CAACK,eAAH,CAAmB,MAAM;MAC9B,OAAOD,QAAQ,CAACD,KAAT,CAAe,IAAf,EAAqBF,SAArB,CAAP;IACD,CAFM,CAAP;EAGD,CAJD;AAKD"},"metadata":{},"sourceType":"script"}