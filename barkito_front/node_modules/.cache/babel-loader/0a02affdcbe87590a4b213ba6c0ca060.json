{"ast":null,"code":"const {\n  SpanStatsEncoder\n} = require('../../encode/span-stats');\n\nconst pkg = require('../../../../../package.json');\n\nconst BaseWriter = require('../common/writer');\n\nconst request = require('../common/request');\n\nconst log = require('../../log');\n\nclass Writer extends BaseWriter {\n  constructor(_ref) {\n    let {\n      url\n    } = _ref;\n    super(...arguments);\n    this._url = url;\n    this._encoder = new SpanStatsEncoder(this);\n  }\n\n  _sendPayload(data, _, done) {\n    makeRequest(data, this._url, (err, res) => {\n      if (err) {\n        log.error(err);\n        done();\n        return;\n      }\n\n      log.debug(`Response from the intake: ${res}`);\n      done();\n    });\n  }\n\n}\n\nfunction makeRequest(data, url, cb) {\n  const options = {\n    path: '/v0.6/stats',\n    method: 'PUT',\n    headers: {\n      'Datadog-Meta-Lang': 'javascript',\n      'Datadog-Meta-Tracer-Version': pkg.version,\n      'Content-Type': 'application/msgpack'\n    }\n  };\n  options.protocol = url.protocol;\n  options.hostname = url.hostname;\n  options.port = url.port;\n  log.debug(() => `Request to the intake: ${JSON.stringify(options)}`);\n  request(data, options, (err, res) => {\n    cb(err, res);\n  });\n}\n\nmodule.exports = {\n  Writer\n};","map":{"version":3,"names":["SpanStatsEncoder","require","pkg","BaseWriter","request","log","Writer","constructor","url","arguments","_url","_encoder","_sendPayload","data","_","done","makeRequest","err","res","error","debug","cb","options","path","method","headers","version","protocol","hostname","port","JSON","stringify","module","exports"],"sources":["/Users/daniel.calderon/Projects/barkito/barkito_front/node_modules/dd-trace/packages/dd-trace/src/exporters/span-stats/writer.js"],"sourcesContent":["\nconst { SpanStatsEncoder } = require('../../encode/span-stats')\n\nconst pkg = require('../../../../../package.json')\n\nconst BaseWriter = require('../common/writer')\nconst request = require('../common/request')\nconst log = require('../../log')\n\nclass Writer extends BaseWriter {\n  constructor ({ url }) {\n    super(...arguments)\n    this._url = url\n    this._encoder = new SpanStatsEncoder(this)\n  }\n\n  _sendPayload (data, _, done) {\n    makeRequest(data, this._url, (err, res) => {\n      if (err) {\n        log.error(err)\n        done()\n        return\n      }\n      log.debug(`Response from the intake: ${res}`)\n      done()\n    })\n  }\n}\n\nfunction makeRequest (data, url, cb) {\n  const options = {\n    path: '/v0.6/stats',\n    method: 'PUT',\n    headers: {\n      'Datadog-Meta-Lang': 'javascript',\n      'Datadog-Meta-Tracer-Version': pkg.version,\n      'Content-Type': 'application/msgpack'\n    }\n  }\n\n  options.protocol = url.protocol\n  options.hostname = url.hostname\n  options.port = url.port\n\n  log.debug(() => `Request to the intake: ${JSON.stringify(options)}`)\n\n  request(data, options, (err, res) => {\n    cb(err, res)\n  })\n}\n\nmodule.exports = {\n  Writer\n}\n"],"mappings":"AACA,MAAM;EAAEA;AAAF,IAAuBC,OAAO,CAAC,yBAAD,CAApC;;AAEA,MAAMC,GAAG,GAAGD,OAAO,CAAC,6BAAD,CAAnB;;AAEA,MAAME,UAAU,GAAGF,OAAO,CAAC,kBAAD,CAA1B;;AACA,MAAMG,OAAO,GAAGH,OAAO,CAAC,mBAAD,CAAvB;;AACA,MAAMI,GAAG,GAAGJ,OAAO,CAAC,WAAD,CAAnB;;AAEA,MAAMK,MAAN,SAAqBH,UAArB,CAAgC;EAC9BI,WAAW,OAAW;IAAA,IAAT;MAAEC;IAAF,CAAS;IACpB,MAAM,GAAGC,SAAT;IACA,KAAKC,IAAL,GAAYF,GAAZ;IACA,KAAKG,QAAL,GAAgB,IAAIX,gBAAJ,CAAqB,IAArB,CAAhB;EACD;;EAEDY,YAAY,CAAEC,IAAF,EAAQC,CAAR,EAAWC,IAAX,EAAiB;IAC3BC,WAAW,CAACH,IAAD,EAAO,KAAKH,IAAZ,EAAkB,CAACO,GAAD,EAAMC,GAAN,KAAc;MACzC,IAAID,GAAJ,EAAS;QACPZ,GAAG,CAACc,KAAJ,CAAUF,GAAV;QACAF,IAAI;QACJ;MACD;;MACDV,GAAG,CAACe,KAAJ,CAAW,6BAA4BF,GAAI,EAA3C;MACAH,IAAI;IACL,CARU,CAAX;EASD;;AAjB6B;;AAoBhC,SAASC,WAAT,CAAsBH,IAAtB,EAA4BL,GAA5B,EAAiCa,EAAjC,EAAqC;EACnC,MAAMC,OAAO,GAAG;IACdC,IAAI,EAAE,aADQ;IAEdC,MAAM,EAAE,KAFM;IAGdC,OAAO,EAAE;MACP,qBAAqB,YADd;MAEP,+BAA+BvB,GAAG,CAACwB,OAF5B;MAGP,gBAAgB;IAHT;EAHK,CAAhB;EAUAJ,OAAO,CAACK,QAAR,GAAmBnB,GAAG,CAACmB,QAAvB;EACAL,OAAO,CAACM,QAAR,GAAmBpB,GAAG,CAACoB,QAAvB;EACAN,OAAO,CAACO,IAAR,GAAerB,GAAG,CAACqB,IAAnB;EAEAxB,GAAG,CAACe,KAAJ,CAAU,MAAO,0BAAyBU,IAAI,CAACC,SAAL,CAAeT,OAAf,CAAwB,EAAlE;EAEAlB,OAAO,CAACS,IAAD,EAAOS,OAAP,EAAgB,CAACL,GAAD,EAAMC,GAAN,KAAc;IACnCG,EAAE,CAACJ,GAAD,EAAMC,GAAN,CAAF;EACD,CAFM,CAAP;AAGD;;AAEDc,MAAM,CAACC,OAAP,GAAiB;EACf3B;AADe,CAAjB"},"metadata":{},"sourceType":"script"}