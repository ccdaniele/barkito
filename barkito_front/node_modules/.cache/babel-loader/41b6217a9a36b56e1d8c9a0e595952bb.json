{"ast":null,"code":"'use strict';\n\nconst Analyzer = require('./vulnerability-analyzer');\n\nconst INSECURE_HASH_ALGORITHMS = new Set(['md4', 'md4WithRSAEncryption', 'RSA-MD4', 'RSA-MD5', 'md5', 'md5-sha1', 'ssl3-md5', 'md5WithRSAEncryption', 'RSA-SHA1', 'RSA-SHA1-2', 'sha1', 'md5-sha1', 'sha1WithRSAEncryption', 'ssl3-sha1'].map(algorithm => algorithm.toLowerCase()));\n\nclass WeakHashAnalyzer extends Analyzer {\n  constructor() {\n    super('WEAK_HASH');\n    this.addSub('datadog:crypto:hashing:start', _ref => {\n      let {\n        algorithm\n      } = _ref;\n      return this.analyze(algorithm);\n    });\n  }\n\n  _isVulnerable(algorithm) {\n    if (typeof algorithm === 'string') {\n      return INSECURE_HASH_ALGORITHMS.has(algorithm.toLowerCase());\n    }\n\n    return false;\n  }\n\n}\n\nmodule.exports = new WeakHashAnalyzer();","map":{"version":3,"names":["Analyzer","require","INSECURE_HASH_ALGORITHMS","Set","map","algorithm","toLowerCase","WeakHashAnalyzer","constructor","addSub","analyze","_isVulnerable","has","module","exports"],"sources":["/Users/daniel.calderon/Projects/barkito/barkito_front/node_modules/dd-trace/packages/dd-trace/src/appsec/iast/analyzers/weak-hash-analyzer.js"],"sourcesContent":["'use strict'\nconst Analyzer = require('./vulnerability-analyzer')\n\nconst INSECURE_HASH_ALGORITHMS = new Set([\n  'md4', 'md4WithRSAEncryption', 'RSA-MD4',\n  'RSA-MD5', 'md5', 'md5-sha1', 'ssl3-md5', 'md5WithRSAEncryption',\n  'RSA-SHA1', 'RSA-SHA1-2', 'sha1', 'md5-sha1', 'sha1WithRSAEncryption', 'ssl3-sha1'\n].map(algorithm => algorithm.toLowerCase()))\n\nclass WeakHashAnalyzer extends Analyzer {\n  constructor () {\n    super('WEAK_HASH')\n    this.addSub('datadog:crypto:hashing:start', ({ algorithm }) => this.analyze(algorithm))\n  }\n\n  _isVulnerable (algorithm) {\n    if (typeof algorithm === 'string') {\n      return INSECURE_HASH_ALGORITHMS.has(algorithm.toLowerCase())\n    }\n    return false\n  }\n}\n\nmodule.exports = new WeakHashAnalyzer()\n"],"mappings":"AAAA;;AACA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,0BAAD,CAAxB;;AAEA,MAAMC,wBAAwB,GAAG,IAAIC,GAAJ,CAAQ,CACvC,KADuC,EAChC,sBADgC,EACR,SADQ,EAEvC,SAFuC,EAE5B,KAF4B,EAErB,UAFqB,EAET,UAFS,EAEG,sBAFH,EAGvC,UAHuC,EAG3B,YAH2B,EAGb,MAHa,EAGL,UAHK,EAGO,uBAHP,EAGgC,WAHhC,EAIvCC,GAJuC,CAInCC,SAAS,IAAIA,SAAS,CAACC,WAAV,EAJsB,CAAR,CAAjC;;AAMA,MAAMC,gBAAN,SAA+BP,QAA/B,CAAwC;EACtCQ,WAAW,GAAI;IACb,MAAM,WAAN;IACA,KAAKC,MAAL,CAAY,8BAAZ,EAA4C;MAAA,IAAC;QAAEJ;MAAF,CAAD;MAAA,OAAmB,KAAKK,OAAL,CAAaL,SAAb,CAAnB;IAAA,CAA5C;EACD;;EAEDM,aAAa,CAAEN,SAAF,EAAa;IACxB,IAAI,OAAOA,SAAP,KAAqB,QAAzB,EAAmC;MACjC,OAAOH,wBAAwB,CAACU,GAAzB,CAA6BP,SAAS,CAACC,WAAV,EAA7B,CAAP;IACD;;IACD,OAAO,KAAP;EACD;;AAXqC;;AAcxCO,MAAM,CAACC,OAAP,GAAiB,IAAIP,gBAAJ,EAAjB"},"metadata":{},"sourceType":"script"}