{"ast":null,"code":"'use strict';\n\nconst DatabasePlugin = require('../../dd-trace/src/plugins/database');\n\nclass MySQLPlugin extends DatabasePlugin {\n  static get name() {\n    return 'mysql';\n  }\n\n  static get system() {\n    return 'mysql';\n  }\n\n  start(_ref) {\n    let {\n      sql,\n      conf: dbConfig\n    } = _ref;\n    const service = getServiceName(this.config, dbConfig);\n    this.startSpan(`${this.system}.query`, {\n      service,\n      resource: sql,\n      type: 'sql',\n      kind: 'client',\n      meta: {\n        'db.type': this.system,\n        'db.user': dbConfig.user,\n        'db.name': dbConfig.database,\n        'out.host': dbConfig.host,\n        'out.port': dbConfig.port\n      }\n    });\n  }\n\n}\n\nfunction getServiceName(config, dbConfig) {\n  if (typeof config.service === 'function') {\n    return config.service(dbConfig);\n  }\n\n  return config.service;\n}\n\nmodule.exports = MySQLPlugin;","map":{"version":3,"names":["DatabasePlugin","require","MySQLPlugin","name","system","start","sql","conf","dbConfig","service","getServiceName","config","startSpan","resource","type","kind","meta","user","database","host","port","module","exports"],"sources":["/Users/daniel.calderon/Projects/barkito/barkito_front/node_modules/dd-trace/packages/datadog-plugin-mysql/src/index.js"],"sourcesContent":["'use strict'\n\nconst DatabasePlugin = require('../../dd-trace/src/plugins/database')\n\nclass MySQLPlugin extends DatabasePlugin {\n  static get name () { return 'mysql' }\n  static get system () { return 'mysql' }\n\n  start ({ sql, conf: dbConfig }) {\n    const service = getServiceName(this.config, dbConfig)\n\n    this.startSpan(`${this.system}.query`, {\n      service,\n      resource: sql,\n      type: 'sql',\n      kind: 'client',\n      meta: {\n        'db.type': this.system,\n        'db.user': dbConfig.user,\n        'db.name': dbConfig.database,\n        'out.host': dbConfig.host,\n        'out.port': dbConfig.port\n      }\n    })\n  }\n}\n\nfunction getServiceName (config, dbConfig) {\n  if (typeof config.service === 'function') {\n    return config.service(dbConfig)\n  }\n\n  return config.service\n}\n\nmodule.exports = MySQLPlugin\n"],"mappings":"AAAA;;AAEA,MAAMA,cAAc,GAAGC,OAAO,CAAC,qCAAD,CAA9B;;AAEA,MAAMC,WAAN,SAA0BF,cAA1B,CAAyC;EACxB,WAAJG,IAAI,GAAI;IAAE,OAAO,OAAP;EAAgB;;EACpB,WAANC,MAAM,GAAI;IAAE,OAAO,OAAP;EAAgB;;EAEvCC,KAAK,OAA2B;IAAA,IAAzB;MAAEC,GAAF;MAAOC,IAAI,EAAEC;IAAb,CAAyB;IAC9B,MAAMC,OAAO,GAAGC,cAAc,CAAC,KAAKC,MAAN,EAAcH,QAAd,CAA9B;IAEA,KAAKI,SAAL,CAAgB,GAAE,KAAKR,MAAO,QAA9B,EAAuC;MACrCK,OADqC;MAErCI,QAAQ,EAAEP,GAF2B;MAGrCQ,IAAI,EAAE,KAH+B;MAIrCC,IAAI,EAAE,QAJ+B;MAKrCC,IAAI,EAAE;QACJ,WAAW,KAAKZ,MADZ;QAEJ,WAAWI,QAAQ,CAACS,IAFhB;QAGJ,WAAWT,QAAQ,CAACU,QAHhB;QAIJ,YAAYV,QAAQ,CAACW,IAJjB;QAKJ,YAAYX,QAAQ,CAACY;MALjB;IAL+B,CAAvC;EAaD;;AApBsC;;AAuBzC,SAASV,cAAT,CAAyBC,MAAzB,EAAiCH,QAAjC,EAA2C;EACzC,IAAI,OAAOG,MAAM,CAACF,OAAd,KAA0B,UAA9B,EAA0C;IACxC,OAAOE,MAAM,CAACF,OAAP,CAAeD,QAAf,CAAP;EACD;;EAED,OAAOG,MAAM,CAACF,OAAd;AACD;;AAEDY,MAAM,CAACC,OAAP,GAAiBpB,WAAjB"},"metadata":{},"sourceType":"script"}